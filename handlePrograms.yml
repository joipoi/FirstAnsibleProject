
- name: Perform full patching
  package:
    name: '*'
    state: latest
- name: Remove undesirable packages
    package:
      name: "{{ unnecessary_software }}"
      state: absent

- name: Stop and disable unnecessary services
  service:
    name: "{{ item }}"
    state: stopped
    enabled: no
  with_items: "{{ unnecessary_services }}"
  ignore_errors: yes
  
- name: Ensure Auditd package is installed
  package:
    name: audit
    state: present  

 - name: Start Auditd service
   service:
     name: auditd
     state: started
     enabled: yes
        
- name: Ensure AIDE package is installed
  package:
    name: aide
    state: present

- name: Initialize AIDE database
  command: aide --init
  
- name: install fapolicyd
  package:
    name: fapolicyd
    state: present
    
- name: Start fapolicyd
  service:
    name: fapolicyd
    state: started
    enabled: yes